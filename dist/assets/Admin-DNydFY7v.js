import{c as b,r,g as p,j as e,I as w,B as o,d as k}from"./index-KRd9DdMF.js";import{u as A}from"./useAdmin-Cz6gzzK_.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=b("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=b("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),S=()=>{const[d,i]=r.useState([]),[c,l]=r.useState(""),[u,g]=r.useState(!1),[m,y]=r.useState(null),[f,t]=r.useState(""),[x,n]=r.useState(!1);r.useEffect(()=>{h()},[]);const h=async()=>{try{n(!0);const a=await p.listAccessKeys();a.success?i(a.keys||[]):t(a.error||"Falha ao buscar chaves")}catch{t("Erro de rede ao buscar chaves")}finally{n(!1)}},j=async a=>{if(a.preventDefault(),!c){t("O rótulo da chave não pode estar vazio");return}try{n(!0),t(""),y(null);const s=await p.generateAccessKey(c,u);s.success?(y(s.key),l(""),g(!1),h()):t(s.error||"Falha ao gerar chave")}catch{t("Erro de rede ao gerar chave")}finally{n(!1)}},N=async a=>{if(confirm("Tem certeza que deseja deletar esta chave?"))try{n(!0);const s=await p.deleteAccessKey(a);s.success?h():t(s.error||"Falha ao deletar chave")}catch{t("Erro de rede ao deletar chave")}finally{n(!1)}},v=a=>{navigator.clipboard.writeText(a).then(()=>{alert("Chave copiada para a área de transferência!")},s=>{alert("Falha ao copiar a chave.")})};return e.jsxs("div",{className:"p-6 bg-gray-800 rounded-lg shadow-md max-w-4xl mx-auto my-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Painel de Administração"}),f&&e.jsx("p",{className:"text-red-400 bg-red-900/20 p-3 rounded-md mb-4",children:f}),e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg mb-6",children:[e.jsx("h3",{className:"text-xl text-white font-semibold mb-3",children:"Gerar Nova Chave de Acesso"}),e.jsxs("form",{onSubmit:j,className:"flex flex-col sm:flex-row items-start sm:items-end gap-4",children:[e.jsxs("div",{className:"flex-grow w-full",children:[e.jsx("label",{htmlFor:"keyLabel",className:"block text-sm font-medium text-gray-300 mb-1",children:"Rótulo"}),e.jsx(w,{id:"keyLabel",type:"text",value:c,onChange:a=>l(a.target.value),placeholder:"Ex: Chave do Marketing",className:"w-full bg-gray-800"})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx("input",{id:"isAdmin",type:"checkbox",checked:u,onChange:a=>g(a.target.checked),className:"h-5 w-5 rounded bg-gray-600 border-gray-500 text-indigo-500 focus:ring-indigo-600"}),e.jsx("label",{htmlFor:"isAdmin",className:"text-gray-300",children:"É Administrador?"})]}),e.jsx(o,{type:"submit",disabled:x,className:"w-full sm:w-auto",children:x?"Gerando...":"Gerar Chave"})]}),m&&e.jsxs("div",{className:"mt-4 p-3 bg-green-900/30 rounded-md flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-300",children:"Chave gerada com sucesso!"}),e.jsx("p",{className:"text-lg font-mono text-white break-all",children:m})]}),e.jsx(o,{onClick:()=>v(m),variant:"secondary",children:"Copiar"})]})]}),e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-xl text-white font-semibold mb-3",children:"Chaves de Acesso Existentes"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-600",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Rótulo"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Admin"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Criada em"}),e.jsx("th",{scope:"col",className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"Ações"})})]})}),e.jsx("tbody",{className:"bg-gray-700 divide-y divide-gray-600",children:d.length>0?d.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:a.label}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:a.is_admin?"Sim":"Não"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:new Date(a.created_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx(o,{onClick:()=>N(a.id),variant:"danger",size:"sm",disabled:x,children:"Deletar"})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-sm text-gray-400",children:"Nenhuma chave encontrada."})})})]})})]})]})};function F(){const{isAdmin:d,loading:i,user:c}=A(),l=k();return r.useEffect(()=>{!i&&!c&&l("/auth")},[i,c,l]),i?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(C,{className:"w-12 h-12 mx-auto text-primary animate-spin mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Verificando permissões..."})]})}):d?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx(S,{})}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-card rounded-lg border border-border p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-destructive/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(K,{className:"w-8 h-8 text-destructive"})}),e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Acesso Negado"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Você não tem permissão para acessar o painel de administração. Esta área é restrita apenas para administradores do sistema."}),e.jsx(o,{onClick:()=>l("/"),className:"w-full",children:"Voltar ao Dashboard"})]})})}export{F as Admin};
