import{c as d,r as a,j as e,I as S,a as le,u as oe,b as de,d as ne,S as ce,B as h,e as ie,M as me}from"./index-KRd9DdMF.js";import{u as xe}from"./useAdmin-Cz6gzzK_.js";import{q as U,c as C,d as M,o as G,g as J,w as ue,a as $,s as R}from"./firebase-Bd6sBVFt.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=d("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=d("Columns2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=d("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=d("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=d("ListTree",[["path",{d:"M21 12h-8",key:"1bmf0i"}],["path",{d:"M21 6H8",key:"1pqkrb"}],["path",{d:"M21 18h-8",key:"1tm79t"}],["path",{d:"M3 6v4c0 1.1.9 2 2 2h3",key:"1ywdgy"}],["path",{d:"M3 10v6c0 1.1.9 2 2 2h3",key:"2wc746"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=d("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=d("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=d("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=d("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=d("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=d("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=d("SquareStack",[["path",{d:"M4 10c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"4i38lg"}],["path",{d:"M10 16c-1.1 0-2-.9-2-2v-4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"mlte4a"}],["rect",{width:"8",height:"8",x:"14",y:"14",rx:"2",key:"1fa9i4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=d("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=d("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Ce(){const[s,l]=a.useState(()=>localStorage.getItem("viewMode")||"columns"),[n,c]=a.useState([]),[i,o]=a.useState(!0),[r,p]=a.useState(null),[g,b]=a.useState({folderId:null,subfolderId:null});a.useEffect(()=>{console.log("useViewManager: Iniciando fetchAllFolders."),(async()=>{try{o(!0),p(null),console.log("useViewManager: Consultando coleção 'folders'...");const x=U(C(M,"folders"),G("created_at","desc")),v=(await J(x)).docs.map(N=>({id:N.id,...N.data()}));console.log("useViewManager: Pastas carregadas com sucesso:",v),c(v)}catch(x){console.error("useViewManager: Erro ao buscar pastas:",x),p(x)}finally{o(!1),console.log("useViewManager: fetchAllFolders finalizado. Loading: ",!1)}})()},[]),a.useEffect(()=>{localStorage.setItem("viewMode",s)},[s]);const m=a.useCallback(f=>{b(x=>({...x,folderId:f,subfolderId:null}))},[]),P=a.useCallback(f=>{b(x=>({...x,subfolderId:f}))},[]);return{viewMode:s,setViewMode:l,allFolders:n,loading:i,error:r,selection:g,selectFolder:m,selectSubfolder:P}}function Me({value:s,onChange:l,placeholder:n="Buscar prompts..."}){return e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(S,{type:"text",placeholder:n,value:s,onChange:c=>l(c.target.value),className:"pl-10"})]})}function X({isOpen:s,onClose:l,title:n,children:c}){return a.useEffect(()=>{const i=o=>{o.key==="Escape"&&l()};return s&&(window.addEventListener("keydown",i),document.body.style.overflow="hidden"),()=>{window.removeEventListener("keydown",i),document.body.style.overflow="unset"}},[s,l]),s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:l}),e.jsxs("div",{className:"relative bg-card border border-border rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto animate-in",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:n}),e.jsx("button",{onClick:l,className:"p-2 rounded-lg hover:bg-muted transition-colors",children:e.jsx(Se,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6",children:c})]})]}):null}function Pe({prompt:s,onClick:l,onDelete:n,onShare:c,onViewVersions:i}){return e.jsxs("div",{className:le("bg-card border border-border rounded-xl p-6 cursor-pointer","transition-all duration-200 hover:shadow-lg hover:scale-105 animate-in","group relative"),onClick:l,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-secondary/10",children:e.jsx(W,{className:"w-6 h-6 text-secondary"})}),e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-all",children:[e.jsx("button",{onClick:o=>{o.stopPropagation(),i==null||i(s)},className:"p-2 rounded-lg hover:bg-muted transition-all",title:"Ver versões",children:e.jsx(he,{className:"w-4 h-4 text-muted-foreground"})}),e.jsx("button",{onClick:o=>{o.stopPropagation(),c==null||c(s)},className:"p-2 rounded-lg hover:bg-muted transition-all",title:"Compartilhar",children:e.jsx(je,{className:"w-4 h-4 text-muted-foreground"})}),e.jsx("button",{onClick:o=>{o.stopPropagation(),n(s.id)},className:"p-2 rounded-lg hover:bg-destructive/10 transition-all",title:"Excluir",children:e.jsx(ke,{className:"w-4 h-4 text-destructive"})})]})]}),e.jsx("h3",{className:"text-lg font-semibold mb-2 line-clamp-1",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:s.content}),s.tags&&s.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[s.tags.slice(0,3).map((o,r)=>e.jsx("span",{className:"px-2 py-1 text-xs rounded-md bg-primary/10 text-primary",children:o},r)),s.tags.length>3&&e.jsxs("span",{className:"px-2 py-1 text-xs rounded-md bg-muted text-muted-foreground",children:["+",s.tags.length-3]})]}),s.created_at&&e.jsx("div",{className:"pt-2 border-t border-border",children:e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString("pt-BR")})})]})}const Z=({item:s,onClick:l,isActive:n})=>e.jsx("button",{onClick:l,className:`w-full text-left p-3 rounded-lg border transition-colors ${n?"bg-primary/10 border-primary text-primary font-semibold":"border-transparent hover:bg-muted"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"w-5 h-5"}),e.jsx("span",{className:"truncate",children:s.name})]})});function K({allFolders:s,selection:l,selectFolder:n,selectSubfolder:c}){const i=s.filter(r=>!r.parent_id),o=l.folderId?s.filter(r=>r.parent_id===l.folderId):[];return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[e.jsx("h2",{className:"text-lg font-bold px-2 pb-2",children:"Pastas Raiz"}),e.jsx("div",{className:"space-y-1",children:i.length>0?i.map(r=>e.jsx(Z,{item:r,onClick:()=>n(r.id),isActive:l.folderId===r.id},r.id)):e.jsx("p",{className:"text-sm text-muted-foreground p-2",children:"Crie uma nova pasta para começar."})})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-4 md:col-span-1",children:[e.jsx("h2",{className:"text-lg font-bold px-2 pb-2",children:"Subpastas"}),e.jsx("div",{className:"space-y-1",children:l.folderId?o.length>0?o.map(r=>e.jsx(Z,{item:r,onClick:()=>c(r.id),isActive:l.subfolderId===r.id},r.id)):e.jsx("p",{className:"text-sm text-muted-foreground p-2",children:"Crie uma nova subpasta."}):e.jsx("p",{className:"text-sm text-muted-foreground p-2",children:"Selecione uma pasta raiz."})})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-4 md:col-span-1",children:[e.jsx("h2",{className:"text-lg font-bold px-2 pb-2",children:"Prompts"}),e.jsx("div",{className:"p-2 text-sm text-muted-foreground",children:l.subfolderId?"Os prompts estão listados na seção abaixo.":"Selecione uma subpasta para ver seus prompts."})]})]})}const Ie=()=>e.jsxs("div",{className:"p-8 bg-card rounded-lg border border-dashed border-secondary/50",children:[e.jsx("h2",{className:"text-xl font-bold text-secondary mb-4",children:"Visualização em Árvore (Em Breve)"}),e.jsx("p",{className:"text-muted-foreground",children:"Esta área irá conter a visualização de pastas e subpastas em formato de árvore expansível."})]}),Ee=()=>e.jsxs("div",{className:"p-8 bg-card rounded-lg border border-dashed border-border",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Visualização Simples (Em Breve)"}),e.jsx("p",{className:"text-muted-foreground",children:"Esta área irá conter a navegação original, passo a passo, focada na simplicidade."})]});function Ae(){const{user:s,signOut:l}=oe(),{theme:n,toggleTheme:c}=de(),{isAdmin:i}=xe(),o=ne(),{viewMode:r,setViewMode:p,allFolders:g,loading:b,selection:m,selectFolder:P,selectSubfolder:f}=Ce(),[x,I]=a.useState([]),[v,N]=a.useState(""),[ze,Y]=a.useState({totalFolders:0,totalPrompts:0,recentDays:0}),[ee,E]=a.useState(!1),[se,z]=a.useState(!1),[Fe,Te]=a.useState(!1),[F,V]=a.useState(""),[Ve,qe]=a.useState(null),[T,q]=a.useState(""),[w,L]=a.useState(""),[_,D]=a.useState(""),[A,k]=a.useState(!1);a.useEffect(()=>{m.subfolderId?B(m.subfolderId):I([])},[m.subfolderId]),a.useEffect(()=>{const t=g.length,u=g.reduce((y,j)=>y+(j.promptCount||0),0);Y({totalFolders:t,totalPrompts:u,recentDays:0})},[g]);const B=async t=>{const u=U(C(M,"prompts"),ue("folder_id","==",t),G("created_at","desc")),j=(await J(u)).docs.map(O=>({id:O.id,...O.data()}));I(j)},H=async()=>{F.trim()&&(await $(C(M,"folders"),{name:F,description:"",parent_id:m.folderId||null,created_at:R(),updated_at:R()}),V(""),E(!1),window.location.reload())},te=async()=>{if(!T.trim()||!w.trim())return;const t=_.split(",").map(u=>u.trim()).filter(Boolean);await $(C(M,"prompts"),{title:T,content:w,tags:t,folder_id:m.subfolderId,version:1,versions:[{content:w,created_at:new Date().toISOString()}],created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),q(""),L(""),D(""),z(!1),B(m.subfolderId)},ae=x.filter(t=>{var y;const u=v.toLowerCase();return t.title.toLowerCase().includes(u)||t.content.toLowerCase().includes(u)||((y=t.tags)==null?void 0:y.some(j=>j.toLowerCase().includes(u)))}),re=()=>{const t={allFolders:g,selection:m,selectFolder:P,selectSubfolder:f};switch(r){case"columns":return e.jsx(K,{...t});case"tree":return e.jsx(Ie,{...t});case"simple":return e.jsx(Ee,{...t});default:return e.jsx(K,{...t})}};return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("header",{className:"border-b border-border bg-card/50 backdrop-blur-sm sticky top-0 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg gradient-primary",children:e.jsx(ce,{className:"w-6 h-6 text-white"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold",children:"Prompt Manager Ultra"})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[i&&e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>o("/admin"),className:"text-primary hover:text-primary",children:e.jsx(Ne,{className:"w-5 h-5"})}),e.jsx(h,{variant:"ghost",size:"sm",onClick:c,children:n==="dark"?e.jsx(ie,{className:"w-5 h-5"}):e.jsx(me,{className:"w-5 h-5"})}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>k(!A),children:e.jsx(ye,{className:"w-5 h-5"})}),A&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-card border border-border rounded-lg shadow-lg z-50",children:e.jsxs("div",{className:"p-2",children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground px-2 mb-1",children:"Modo de Exibição"}),e.jsxs("button",{onClick:()=>{p("columns"),k(!1)},className:`w-full flex items-center gap-2 text-left text-sm p-2 rounded-md hover:bg-muted ${r==="columns"?"text-primary":""}`,children:[e.jsx(pe,{className:"w-4 h-4"})," Colunas"]}),e.jsxs("button",{onClick:()=>{p("tree"),k(!1)},className:`w-full flex items-center gap-2 text-left text-sm p-2 rounded-md hover:bg-muted ${r==="tree"?"text-primary":""}`,children:[e.jsx(fe,{className:"w-4 h-4"})," Árvore"]}),e.jsxs("button",{onClick:()=>{p("simple"),k(!1)},className:`w-full flex items-center gap-2 text-left text-sm p-2 rounded-md hover:bg-muted ${r==="simple"?"text-primary":""}`,children:[e.jsx(we,{className:"w-4 h-4"})," Simples"]})]})})]}),e.jsx(h,{variant:"secondary",size:"sm",onClick:l,children:e.jsx(be,{className:"w-5 h-5"})})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Navegação"}),e.jsx("div",{className:"flex gap-3",children:e.jsxs(h,{onClick:()=>E(!0),children:[e.jsx(Q,{className:"w-5 h-5 mr-2"}),m.folderId?"Nova Subpasta":"Nova Pasta"]})})]}),b?e.jsx("p",{children:"Carregando..."}):re(),m.subfolderId&&e.jsxs("section",{className:"mt-12",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Prompts"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 w-full md:w-auto",children:[e.jsx(Me,{value:v,onChange:N}),m.subfolderId&&e.jsxs(h,{onClick:()=>z(!0),children:[e.jsx(Q,{className:"w-5 h-5 mr-2"}),"Novo Prompt"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ae.map(t=>e.jsx(Pe,{prompt:t},t.id))}),x.length===0&&!b&&e.jsxs("div",{className:"text-center py-12 col-span-full",children:[e.jsx(W,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Nenhum prompt nesta subpasta."})]})]})]}),e.jsx(X,{isOpen:ee,onClose:()=>E(!1),title:m.folderId?"Nova Subpasta":"Nova Pasta",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{value:F,onChange:t=>V(t.target.value),onKeyDown:t=>t.key==="Enter"&&H(),placeholder:"Nome da pasta..."}),e.jsx(h,{onClick:H,className:"w-full",children:"Criar"})]})}),e.jsx(X,{isOpen:se,onClose:()=>z(!1),title:"Novo Prompt",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{value:T,onChange:t=>q(t.target.value),placeholder:"Título do prompt..."}),e.jsx("textarea",{value:w,onChange:t=>L(t.target.value),className:"w-full h-40 px-3 py-2 rounded-lg border border-input bg-background text-sm resize-none",placeholder:"Conteúdo do prompt..."}),e.jsx(S,{value:_,onChange:t=>D(t.target.value),placeholder:"Tags separadas por vírgula..."}),e.jsx(h,{onClick:te,className:"w-full",children:"Criar Prompt"})]})})]})}export{Ae as Dashboard};
